@if (headerConfig(); as config) {
  @if (config.enable) {
    <mat-toolbar
      class="lf-header lf-transitions mat-elevation-z3"
      [class.px-4]="!isMobile()"
      [class.px-1]="isMobile()"
      [ngClass]="config.cssClass"
      [class.lf-gradient]="config.gradient"
      color="primary">
      <!-- left menu button -->
      <ng-container
        [ngTemplateOutlet]="menuButtonTemplate"
        [ngTemplateOutletContext]="{
          menuButton: config.leftMenuButton!,
          hideLabel: true,
        }"></ng-container>
      <!-- logo & title -->
      <div
        class="lf-header-logo-title-wrapper ml-1 mr-2"
        [class.ml-10]="config.leftMenuButton && !isMobile()">
        <!-- link wrapper -->
        <div
          class="lf-header-logo-title-wrapper-link"
          [class.lf-clickable]="config.titleRouterLink"
          [routerLink]="config.titleRouterLink ? [config.titleRouterLink] : null">
          <!-- svg logo -->
          @if (config.svgLogo) {
            <mat-icon
              class="lf-header-logo"
              [class.mr-3]="config.title"
              [svgIcon]="config.svgLogo!"></mat-icon>
            <!-- img logo -->
          } @else {
            @if (config.imgLogo) {
              <img
                class="lf-header-logo"
                [class.mr-3]="config.title"
                [src]="config.imgLogo"
                alt="Logo" />
            }
          }
          <!-- title -->
          @if (config.title) {
            <div class="lf-header-title-wrapper">
              @if (config.title) {
                <span class="lf-header-title">
                  {{ config.title }}
                </span>
              }
              @if (config.subtitle) {
                <span class="lf-header-subtitle">
                  {{ config.subtitle }}
                </span>
              }
            </div>
          }
        </div>
      </div>
      <!-- input -->
      @if (config.inputConfig?.enable) {
        <div class="spacer"></div>
        <lf-input
          [class.lf-header-input-mobile]="isMobile()"
          [class.mx-3]="!isMobile()"
          [inputConfig]="config.inputConfig!"
          [isMobile]="isMobile()"
          (inputSubmitEvent)="inputSubmitted($event)"
          (inputChangeEvent)="inputChanged($event)"
          (inputPrefixActionEvent)="inputClosed()"></lf-input>
      }
      <!-- spacer -->
      <div class="spacer"></div>
      <!-- right menu buttons -->
      @if (config.responsiveConfig?.enable && isMobile()) {
        @let exludedButtons = rightExcludedButtons();
        @for (button of exludedButtons; track button.id) {
          <ng-container
            [ngTemplateOutlet]="menuButtonTemplate"
            [ngTemplateOutletContext]="{
              menuButton: button,
            }"></ng-container>
        }
        @let mobileButton = rightMobileButton();
        <ng-container
          [ngTemplateOutlet]="menuButtonTemplate"
          [ngTemplateOutletContext]="{
            menuButton: mobileButton,
          }"></ng-container>
      } @else {
        @for (button of config.rightMenuButtons; track button.id) {
          <ng-container
            [ngTemplateOutlet]="menuButtonTemplate"
            [ngTemplateOutletContext]="{
              menuButton: button,
            }"></ng-container>
        }
      }
    </mat-toolbar>
    <!-- loading bar -->
    @if (config.loading || (config.showRouteLoading && routeLoading())) {
      <mat-progress-bar
        class="lf-header-progress-bar"
        color="accent"
        mode="indeterminate"></mat-progress-bar>
    }
  }
}

<!-- header menu button -->
<ng-template #menuButtonTemplate let-menuButton="menuButton" let-hideLabel="hideLabel">
  @if (menuButton) {
    <!-- label button -->
    @if (menuButton.label && !hideLabel) {
      <button
        mat-button
        class="lf-header-menu-button"
        [class.lf-header-menu-button-active]="isActive()(menuButton.id) && !menuButton.disabled"
        [ngClass]="menuButton.cssClass"
        [disabled]="menuButton.disabled"
        (click)="buttonClicked(menuButton.id)"
        [matMenuTriggerFor]="menuButton.menuButtons ? menu : null"
        [aria-label]="menuButton.label || menuButton.tooltip"
        [matTooltip]="menuButton.tooltip">
        <!-- icon -->
        @if (menuButton.matIcon) {
          <mat-icon [class.material-icons-outlined]="libraryConfig()?.outlineIcons">
            {{ menuButton.matIcon }}
          </mat-icon>
        } @else if (menuButton.svgIcon) {
          <mat-icon [svgIcon]="menuButton.svgIcon"></mat-icon>
        }
        <!-- label -->
        {{ menuButton.label }}
      </button>
      <!-- icon button -->
    } @else if (menuButton.matIcon || menuButton.svgIcon) {
      <button
        mat-icon-button
        class="lf-header-menu-button"
        [ngClass]="menuButton.cssClass"
        [disabled]="menuButton.disabled"
        (click)="buttonClicked(menuButton.id)"
        [matMenuTriggerFor]="menuButton.menuButtons ? menu : null"
        [matTooltip]="menuButton.tooltip"
        [aria-label]="menuButton.id || menuButton.tooltip">
        <!-- icon -->
        @if (menuButton.matIcon) {
          <mat-icon [class.material-icons-outlined]="libraryConfig()?.outlineIcons">
            {{ menuButton.matIcon }}
          </mat-icon>
        } @else if (menuButton.svgIcon) {
          <mat-icon [svgIcon]="menuButton.svgIcon"></mat-icon>
        }
      </button>
      <!-- img button -->
    } @else if (menuButton.imgIcon) {
      <img
        class="lf-header-menu-img px-1"
        [src]="menuButton.imgIcon"
        width="48"
        height="48"
        [ngClass]="menuButton.cssClass"
        (click)="buttonClicked(menuButton.id)"
        [matMenuTriggerFor]="menuButton.menuButtons ? menu : null"
        [matTooltip]="menuButton.tooltip"
        [aria-label]="menuButton.id || menuButton.tooltip" />
    }
    <!-- menu -->
    <mat-menu #menu="matMenu">
      <!-- label menu buttons -->
      @for (button of menuButton.menuButtons; track button.id) {
        <!-- menu button -->
        @if (button.label) {
          <button
            mat-menu-item
            [class.lf-header-menu-button-active]="isActive()(button.id)"
            [ngClass]="button.cssClass"
            [disabled]="button.disabled"
            (click)="buttonClicked(button.id)"
            [matTooltip]="button.tooltip"
            [aria-label]="button.label">
            <!-- icon -->
            @if (button.matIcon) {
              <mat-icon [class.material-icons-outlined]="libraryConfig()?.outlineIcons">
                {{ button.matIcon }}
              </mat-icon>
            } @else if (button.svgIcon) {
              <mat-icon [svgIcon]="button.svgIcon"></mat-icon>
            }
            <!-- label -->
            <span>{{ button.label }}</span>
          </button>
        }
      }
      <!-- icon menu buttons -->
      <div mat-menu-item class="lf-menu-icons px-1" [disableRipple]="true">
        @for (button of menuButton.menuButtons; track button.id) {
          <!-- icon button -->
          @if (!button.label && (button.matIcon || button.svgIcon)) {
            <button
              mat-icon-button
              class="lf-menu-icon-button"
              [ngClass]="button.cssClass"
              [disabled]="button.disabled"
              (click)="buttonClicked(button.id)"
              [matTooltip]="button.tooltip"
              [aria-label]="button.id || button.tooltip"
              tabindex="0">
              <!-- icon -->
              @if (button.matIcon) {
                <mat-icon [class.material-icons-outlined]="libraryConfig()?.outlineIcons">
                  {{ button.matIcon }}
                </mat-icon>
              } @else if (button.svgIcon) {
                <mat-icon [svgIcon]="button.svgIcon"></mat-icon>
              }
            </button>
          }
        }
      </div>
    </mat-menu>
  }
</ng-template>
