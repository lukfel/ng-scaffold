<!-- lf-list.component.html -->
<div class="lf-table">
  <!-- Header -->
  @if (header) {
    <div class="lf-table-item lf-table-item-header">
      <!-- avatar -->
      @if (header.avatar) {
        <div class="lf-table-item-avatar">
          <img [src]="header.avatar" alt="Avatar of header" />
          <!-- (error)="onImageError($event)" -->
        </div>
      } @else if (header.matIcon || header.svgIcon) {
        <div class="lf-table-item-avatar">
          <lf-icon [matIcon]="header.matIcon" [svgIcon]="header.svgIcon"></lf-icon>
        </div>
      } @else if (hasAvatars) {
        <div class="lf-table-item-avatar"></div>
      }

      <!-- title -->
      <div class="lf-table-item-title-wrapper flex-row">
        @for (token of header.tokens; track $index) {
          <span
            [class.clickable]="header.enableSorting && sortToken === token"
            (click)="updateSortToken(token)">
            {{ token }}
            @if (header.enableSorting && sortToken === token) {
              <mat-icon class="lf-table-item-sort-icon">
                {{ sortAsc ? "arrow_downward" : "arrow_upward" }}
              </mat-icon>
            }
          </span>
        }
      </div>

      <!-- buttons -->
      <div class="lf-table-item-buttons"></div>

      <!-- checkbox -->
      @if (header.enableSelection) {
        <div class="lf-table-item-checkbox">
          <mat-checkbox
            [checked]="allSelected"
            [indeterminate]="someSelected"
            (change)="selectAll($event)"></mat-checkbox>
        </div>
      }
    </div>
    <mat-divider></mat-divider>
  }

  <!-- Items -->
  @for (item of items; track item.id) {
    <div class="lf-table-item lf-table-item-data" [class.active]="item.checked">
      <!-- avatar -->
      @if (item.avatar) {
        <div class="lf-table-item-avatar">
          <img [src]="item.avatar" [alt]="'Avatar of ' + item.title" />
          <!-- (error)="onImageError($event)" -->
        </div>
      } @else if (item.matIcon || item.svgIcon) {
        <div class="lf-table-item-avatar">
          <lf-icon [matIcon]="item.matIcon" [svgIcon]="item.svgIcon"></lf-icon>
        </div>
      }

      <!-- title -->
      <div class="lf-table-item-title-wrapper">
        <span class="lf-table-item-title">
          <span>{{ item.title }}</span>
        </span>
        @if (item.subtitle) {
          <span class="lf-table-item-subtitle">{{ item.subtitle }}</span>
        }
      </div>

      <!-- buttons -->
      <div class="lf-table-item-buttons">
        @for (button of buttons; track button.id) {
          @if (!item.hiddenActions?.includes(button.id)) {
            @if (button.label) {
              <button
                mat-button
                class="lf-bottom-bar-button ml-2"
                [ngClass]="button.class"
                (click)="buttonClickEvent.emit({ id: button.id, item })"
                [disabled]="button.disabled || item.disabledActions?.includes(button.id)"
                [matTooltip]="button.tooltip">
                @if (button.matIcon || button.svgIcon) {
                  <lf-icon
                    [matIcon]="button.matIcon"
                    [svgIcon]="button.svgIcon"
                    [alignMiddle]="true"></lf-icon>
                }
                {{ button.label }}
              </button>
            } @else {
              <button
                mat-icon-button
                class="lf-bottom-bar-button-icon ml-2"
                [ngClass]="button.class"
                (click)="buttonClickEvent.emit({ id: button.id, item })"
                [disabled]="button.disabled || item.disabledActions?.includes(button.id)"
                [matTooltip]="button.tooltip">
                <lf-icon [matIcon]="button.matIcon" [svgIcon]="button.svgIcon"></lf-icon>
              </button>
            }
            <!-- [color]="button.color" -->
          }
        }
      </div>

      <!-- checkbox -->
      @if (header?.enableSelection) {
        <div class="lf-table-item-checkbox">
          <mat-checkbox [(ngModel)]="item.checked" (ngModelChange)="selectItem()"></mat-checkbox>
        </div>
      }
    </div>
  } @empty {
    <div class="lf-table-item-no-items">No items found.</div>
  }
</div>
